# 移除标题栏

## 自定义无边框标题栏

Windows 原生的大白条标题栏在暗黑模式下很“出戏”。

要想让应用看起来像 VS Code 或 Chrome 那样专业，**最佳实践**是：
1.  **隐藏**系统的原生标题栏。
2.  **手写**一个 HTML/CSS 标题栏。
3.  **利用** Tailwind 的颜色变量，让它自动适配明亮/暗黑模式。

---

## 第一步：拆掉“旧屋顶” (配置 Tauri)

打开 `src-tauri/tauri.conf.json`，找到 `app` -> `windows` 数组，在第一个窗口配置里添加 `"decorations": false` 和 `"shadow": true`。

修改后的代码如下：

```json
"windows": [
  {
    "label": "main",
    "title": "XGTools",
    "width": 800,
    "height": 600,
    "decorations": false,  // <--- 隐藏原生标题栏
    "shadow": true         // <--- 保留窗口阴影 (Windows/macOS)
  }
],
```

> **注意**：保存后，你的窗口可能会暂时失去拖动和关闭的能力，别慌，马上加回来。

---

## 第二步：建造“新屋顶” (创建 TitleBar 组件)

我们需要创建一个全新的组件来实现标题栏的功能（拖动、最小化、最大化、关闭）。

新建文件：`src/components/TitleBar.vue`

```vue
<script setup lang="ts">
import { Window } from '@tauri-apps/api/window';
import { ref, onMounted } from 'vue';

// 获取当前窗口实例
const appWindow = Window.getCurrent();
const isMaximized = ref(false);

// 最小化
const minimize = () => appWindow.minimize();

// 最大化/还原
const toggleMaximize = async () => {
    await appWindow.toggleMaximize();
    isMaximized.value = await appWindow.isMaximized();
};

// 关闭
const close = () => appWindow.close();

// 初始化时检查状态
onMounted(async () => {
    isMaximized.value = await appWindow.isMaximized();
});
</script>

<template>
    <!-- 
    data-tauri-drag-region: 这是关键属性！
    它告诉 Tauri：按住这块区域可以拖动窗口。
  -->
    <div data-tauri-drag-region
        class="h-10 flex items-center justify-between bg-background select-none fixed top-0 left-0 right-0 z-50">
        <!-- border-b 下方加条横线，但是我不要....-->
         
        <!-- 左侧 -->
        <!-- pointer-events-none 防止图标拦截拖动事件 -->
        <div></div>

        <!-- 右侧：窗口控制按钮 -->
        <!-- 这里的按钮不需要拖动功能，所以正常点击即可 -->
        <div class="flex h-full">

            <!-- 最小化 -->
            <button @click="minimize"
                class="w-12 h-full flex items-center justify-center hover:bg-muted transition-colors text-foreground">
                <span class="icon-[lucide--minus]"></span>
            </button>

            <!-- 最大化/还原 -->
            <button @click="toggleMaximize"
                class="w-12 h-full flex items-center justify-center hover:bg-muted transition-colors text-foreground">
                <span class="icon-[lucide--square]"></span>
            </button>

            <!-- 关闭 (红色背景高亮) -->
            <button @click="close"
                class="w-12 h-full flex items-center justify-center hover:bg-red-500 hover:text-white transition-colors text-foreground">
                <span class="icon-[lucide--x]"></span>
            </button>
        </div>
    </div>
</template>
```

**代码解析：**
1.  **`data-tauri-drag-region`**: 这个 HTML 属性是黑魔法。只要加上它，这块 `div` 就变成了窗口的“把手”，按住它就能拖动整个窗口。
2.  **Tailwind 颜色**:
    *   `bg-background`: 跟随系统背景色（自动适配黑/白）。
    *   `border-b`: 底部加一条细边框，更有层次感。
    *   `hover:bg-red-500`: 关闭按钮悬停变红，这是 Windows 的经典设计规范。
3.  **`fixed top-0`**: 固定在顶部，不随内容滚动。

---

## 第三步：授权“钥匙” (配置 Capabilities)

在 Tauri v2 中，为了安全，前端默认是不能随意控制窗口的（不能最小化、关闭，甚至不能拖动）。我们需要明确给它“发钥匙”。

打开 `src-tauri/capabilities/default.json`，在 `permissions` 列表中添加以下权限：

```json
"permissions": [
  "core:default",
  "core:window:allow-minimize",
  "core:window:allow-maximize",
  "core:window:allow-unmaximize",
  "core:window:allow-toggle-maximize",
  "core:window:allow-is-maximized",
  "core:window:allow-start-dragging",
  "core:window:allow-close",
  // ... 其他原有权限保持不变
  "opener:default"
]
```

**关键权限解析：**
*   **`allow-start-dragging`**: 让 `data-tauri-drag-region` 生效（**解决无法拖动的问题**）。
*   **`allow-minimize/maximize/close`**: 让右上角的三个按钮生效。

---

## 第四步：安装“屋顶” (修改 App.vue)

最后，我们需要把这个组件放到所有页面的最顶层。

打开 `src/App.vue`，做以下修改：

1.  **引入组件**：
```ts
import TitleBar from './components/TitleBar.vue';
```

2.  **调整布局**：
    由于标题栏是 `fixed` 定位的（高度 10 为 2.5rem/40px），我们需要把下面的主界面整体下移，否则内容会被遮住。

修改后的 `template` 部分结构如下：

```vue
<template>
  <div class="h-screen w-screen overflow-hidden bg-background text-foreground flex flex-col">
    
    <!-- 1. 顶部标题栏 -->
    <TitleBar />

    <!-- 2. 下方主体内容 (Sidebar + Content) -->
    <!-- pt-10 对应 h-10，留出标题栏的高度 -->
    <div class="flex-1 flex overflow-hidden pt-10">
      
    </div>
    
  </div>
</template>
```
